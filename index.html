<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Á≤æÂäõÁîµÊ±†</title>
  <style>
    :root {
      --bg: #f5f5f7;
      --card: #ffffff;
      --text: #222;
      --sub: #666;
      --glow: rgba(0,255,150,0.6);
    }
    [data-theme="dark"] {
      --bg: #111827;
      --card: #1f2937;
      --text: #f3f4f6;
      --sub: #9ca3af;
      --glow: rgba(0,255,200,0.8);
    }
    body {
      margin: 0;
      font-family: "SF Pro Display", "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      padding: 20px;
      user-select: none;
    }
    .container {
      max-width: 420px;
      margin: auto;
      background: var(--card);
      border-radius: 30px;
      padding: 25px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      text-align: center;
    }
    .battery-box {
      position: relative;
      width: 120px;
      height: 260px;
      margin: 25px auto;
      border-radius: 20px;
      overflow: hidden;
      background: #2225;
      backdrop-filter: blur(10px);
      border: 3px solid #9994;
      box-shadow: 0 0 25px var(--glow);
      touch-action: none;
    }
    .battery-head {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      width: 55px;
      height: 22px;
      background: #6668;
      border-radius: 6px;
      border: 2px solid #9994;
    }
    .fill {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 50%;
      transition: height 0.3s cubic-bezier(.3,1.3,.4,1);
      filter: brightness(1.2);
    }
    .value {
      font-size: 32px;
      font-weight: 700;
      margin-top: 10px;
    }
    .mode-bar {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }
    .icon-btn {
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #e5e7eb;
      border-radius: 14px;
      font-size: 26px;
      cursor: pointer;
    }
    .icon-btn.active {
      box-shadow: 0 0 12px var(--glow);
      transform: scale(1.1);
    }
    [data-theme="dark"] .icon-btn {
      background:#374151;
      color:white;
    }
    .charge-config {
      margin-top: 15px;
      font-size: 14px;
      color: var(--sub);
    }
    .charge-config input {
      width: 70px;
      padding: 4px;
      border-radius: 6px;
      border: 1px solid #8884;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 style="margin:0; font-size:26px; font-weight:700;">Energy Battery</h2>
    <div class="battery-box" id="battery">
      <div class="battery-head"></div>
      <div class="fill" id="fill"></div>
    </div>

    <div class="value" id="valueText">50%</div>

    <div class="mode-bar">
      <div class="icon-btn" id="darkBtn">üåô</div>
      <div class="icon-btn" id="chargeBtn">‚ö°</div>
    </div>

    <div class="charge-config" id="chargeConfig" style="display:none;">
      ÂÖÖÁîµÔºöÊØè <input type="number" id="chargeMin" min="1" value="1" /> ÂàÜÈíü +10%
    </div>
  </div>

  <script>
    const battery = document.getElementById("battery");
    const fill = document.getElementById("fill");
    const valueText = document.getElementById("valueText");
    const html = document.documentElement;

    const darkBtn = document.getElementById("darkBtn");
    const chargeBtn = document.getElementById("chargeBtn");
    const chargeConfig = document.getElementById("chargeConfig");
    const chargeMinInput = document.getElementById("chargeMin");

    let value = 50;
    let isDragging = false;
    let chargeTimer = null;

    function clamp10(v){ return Math.max(0, Math.min(100, Math.round(v/10)*10)); }

    function update(v){
      value = clamp10(v);
      fill.style.height = value + "%";
      valueText.textContent = value + "%";

      if (value >= 80) fill.style.background = "linear-gradient(#22ff99,#66ffcc)";
      else if (value >= 50) fill.style.background = "linear-gradient(#facc15,#f59e0b)";
      else if (value >= 20) fill.style.background = "linear-gradient(#fb923c,#ef4444)";
      else fill.style.background = "linear-gradient(#ef4444,#ec4899)";
    }

    // ÊãñÂä®ÁîµÊ±†Ë∞ÉÊï¥ÁîµÈáè
    function handleDrag(clientY){
      const rect = battery.getBoundingClientRect();
      const h = rect.height;
      const offset = rect.bottom - clientY;
      let percent = (offset / h) * 100;
      update(percent);
    }
    battery.addEventListener("mousedown", e=>{ isDragging=true; handleDrag(e.clientY); });
    window.addEventListener("mousemove", e=>{ if(isDragging) handleDrag(e.clientY); });
    window.addEventListener("mouseup", ()=>isDragging=false);
    battery.addEventListener("touchstart", e=>{ isDragging=true; handleDrag(e.touches[0].clientY); }, {passive:false});
    battery.addEventListener("touchmove", e=>{ handleDrag(e.touches[0].clientY); }, {passive:false});
    window.addEventListener("touchend", ()=>isDragging=false);

    // ÈªëÊöóÊ®°Âºè
    darkBtn.onclick = ()=>{
      html.dataset.theme = html.dataset.theme==='dark'?'light':'dark';
    };

    // ÊâãÂä®ÂÖÖÁîµ
    chargeBtn.onclick = ()=>{
      if(chargeTimer){
        clearInterval(chargeTimer);
        chargeTimer = null;
        chargeConfig.style.display='none';
      } else {
        const min = Number(chargeMinInput.value)||1;
        chargeConfig.style.display='block';
        chargeTimer = setInterval(()=>{
          if(value<100) update(value+10);
        }, min*60000);
      }
    };

    update(50);
  </script>
</body>
</html>
